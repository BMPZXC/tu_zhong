[gd_scene load_steps=6 format=3 uid="uid://rxjrhmrrksql"]

[ext_resource type="Script" uid="uid://ddxd3e68gj4d7" path="res://Entity/血条_显示.gd" id="1_1tn36"]
[ext_resource type="Script" uid="uid://iubl2fg1wf6e" path="res://Entity/攻击区.gd" id="1_6oee2"]

[sub_resource type="GDScript" id="GDScript_807mj"]
script/source = "@tool
extends 生物
var 字体=preload(\"res://Entity/字体系_怪物/dingliehuobanfont20241217-2.ttf\")
@export var 字:String=\"无\":
	set(a):
		字=a
		if a.length()!=1:return
		queue_redraw()
@export var 敌人:CharacterBody2D


func _ready() -> void:
	if Engine.is_editor_hint():set_process(false)
func _draw() -> void:
	var 左下角=字体.get_string_size(字)*Vector2(-0.5,0.5)
	draw_char(字体,左下角,字,16)
	
var 落地_等待:float=0
func _physics_process(delta: float) -> void:
	if Engine.is_editor_hint():
		set_process(false)
		return
	if is_on_floor():
		if velocity.y>0:velocity.y=0
		velocity+=+(Vector2.ZERO-velocity)*delta*10
		落地_等待+=delta
		if 落地_等待>0.4 and 敌人:
			落地_等待=0
			velocity+=Vector2(50,-50)*2
			velocity.x=velocity.x* sign(敌人.global_position.x-global_position.x)
	else :
		velocity.y+=20
	move_and_slide()

func _on_死亡() -> void:
	queue_free()
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_807mj"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_6oee2"]
size = Vector2(14, 14)

[node name="CharacterBody2D" type="CharacterBody2D"]
collision_layer = 4
collision_mask = 5
script = SubResource("GDScript_807mj")
"质量" = 0.5

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource("RectangleShape2D_807mj")

[node name="Area2D" type="Area2D" parent="." node_paths=PackedStringArray("a")]
collision_layer = 0
collision_mask = 2
script = ExtResource("1_6oee2")
a = NodePath("..")
"击飞强度" = 3.0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Area2D"]
position = Vector2(0, 1)
shape = SubResource("RectangleShape2D_6oee2")

[node name="血条" type="Node2D" parent="." node_paths=PackedStringArray("目标")]
position = Vector2(-16, 6)
script = ExtResource("1_1tn36")
"目标" = NodePath("..")
metadata/_custom_type_script = "uid://ddxd3e68gj4d7"

[connection signal="死亡" from="." to="." method="_on_死亡"]
